environment:
  # Nuxt requires node v8 minimum
  nodejs_version: '12'
  # Encrypt sensitive data (https://ci.appveyor.com/tools/encrypt)
  APPVEYOR_SSH_KEY:
    secure: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAADfo04yi/fbAWJhMEnJqR6M8l5bbp+rK+ilozcGe2dSRamAHMWZhJhXvzvYNase/ht3w0XHrlTR6XCuuYnneY199+ppRlXciRYp+Vuxeo3EsD8ljlLf8aTkTA/RNnQxbxNhU1sXMMEnZ9JIMEuRwno5XbRXiHQVusmx/A/HkrhE6wHwEaRczehLEnJ7auTfXlfw3vExAYdPIVMuX67uHxhxHo4aMqWW98JkuxFUXQBShWsqkHL2deUHhWYAXUmXRT9ibeMgar11o5LFmZl8FHmNguAN/SgxPN43pDfU5SQYgFZVwpXZ7RJygw5bpkQQ+5nwr9DJxOkedLwOouf7FEk= francisco@posiziona.eu
  github_access_token:
    secure: 3z4H3FxmywspE5pGW2tgYnCrUqvELGif1qs5TAa1GXgX3KfjKMkvzkbdU+RuEPRV
  github_email:
    secure: 2Mo62WwerizFrQq5EtvCKg==

# Only run on master branch
branches:
  only:
    - master

# Install scripts. (runs after repo cloning)
install:
  # switch nodejs version
  - ps: Install-Product node $env:nodejs_version
  - ssh-add $($env:APPVEYOR_SSH_KEY)
  # install modules
  - npm install
  # generate static files
  - npm run generate
  # configure global git credentials store (https://www.appveyor.com/docs/how-to/git-push/)
  - git config --global credential.helper store
  - ps: Add-Content "$env:USERPROFILE\.git-credentials" "https://$($env:github_access_token):x-oauth-basic@github.com`n"
  - git config --global user.email $env:github_email
  # deploy to GitHub pages
  - npm run deploy

# No tests to run
test: off

# Don't actually build.
build: off